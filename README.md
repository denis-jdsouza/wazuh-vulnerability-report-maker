# Wazuh vulnerability report maker
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)

## Overview
Tool to generate vulnerability reports from Wazuh\
Reports will be generated via CLI output, CSV file & JPG image

## Requirements
- Python3.10
- Below environment variables should be set before running the tool
  - WAZUH_HOST &emsp;# Wazuh server domain/IP
  - WAZUH_USER &emsp;# Wazuh API user-name
  - WAZUH_PASSWD &emsp;# Wazuh API password

## Usage
``` 
python3 wazuh_vuln_report.py
``` 

## Options
```
-n, --name :     Only return vulnerabilities for specified package (optional)
-s, --severity : Only return vulnerabilities of that severity (optional)
-c, --cve :      Only return vulnerabilities with that CVE (optional)
-g, --group :    Only return vulnerabilities for group members (optional)
```

## Example CLI output
```
List of agents and number of vulnerabilities on each:

Agent Name      Id  OS        Crit    High    Medium    Low    Total
------------  ----  ------  ------  ------  --------  -----  -------
test-agent-5   033  amzn        46     450       217      8      726
test-agent-6   034  ubuntu      14     194       104     11      323
test-agent-2   029  amzn         0       5         5      2       12
test-agent-4   031  amzn         0       5         0      0        6
test-agent-0   024  amzn         0       2         0      1        3

List of vulnerabilities by Severity:

Severity      Count
----------  -------
High            656
Medium          327
Critical         60
Low              22

List of vulnerabilities by Name:

Name                           Count
---------------------------  -------
vim-common                        87
vim-minimal                       59
xxd                               28
vim                               28
curl                              25
libcurl                           25
grub2-common                      22
libtiff                           18
grub-pc                           13
grafana                           12

List of vulnerabilities by CVE:

CVE               Count
--------------  -------
CVE-2022-2601        13
CVE-2023-26604       11
CVE-2022-3324        10
CVE-2022-4292        10
CVE-2022-3234        10
CVE-2022-3491        10
CVE-2021-3697         9
CVE-2021-3695         9
```

## Example summary report
<img src="reports/summary_vuln_report_example.jpg" width="750">

## License
Code released under the [MIT License](https://opensource.org/licenses/MIT)
